<div class="df jc-b m-b-15">
  <h1 class="m-t-0 m-b-0 fs-24 fw-600">
    Business
  </h1>
  <div *ngIf="data.length">
    <button [routerLink]="[ '/main/business/create-business' ]" class="cust-button" nbButton status="success">
      + Add User
    </button>
  </div>
</div>
<nb-card>
  <nb-card-body>
    <div *ngIf="showLoader" class="loader-table">
      <img width="70px" src="assets/img/Loader2x.gif" alt="">
    </div>
    <nb-tabset  *ngIf="!showLoader" class="tabs-card">
      <nb-tab tabTitle="Business Users">
        <div class="check-all-wrap">
          <div *ngIf="data.length" class="all">
            <nb-checkbox [(ngModel)]="checkAll">All</nb-checkbox>
          </div>
          <div *ngIf="data.length" (click)="inviteAll()" class="invite">
            <img src="assets/img/mail-icon.png" alt="">
            Invite All
          </div>
        </div>
        <div class="box-container">

          <table *ngIf="data.length" class="m-b-40" [nbTreeGrid]="data">
            <tr nbTreeGridHeaderRow *nbTreeGridHeaderRowDef="allColumns"></tr>
            <tr nbTreeGridRow *nbTreeGridRowDef="let row; columns: allColumns"></tr>

            <ng-container *ngFor="let column of defaultColumns" [nbTreeGridColumnDef]="column">
              <th nbTreeGridHeaderCell *nbTreeGridHeaderCellDef>
                <span *ngIf="column !== 'Check'">
                  {{column}}
                </span>
              </th>
              <td [ngClass]="{'check-row-bg': checkAll}" nbTreeGridCell *nbTreeGridCellDef="let row">

                <div class="df ai-c">
                  <span *ngIf="column === 'Permission'">
                    <img class="m-r-8" *ngIf="row.data[column] === 'YES'" src="assets/svg-icon/permission-yes.svg" alt="">
                    <img class="m-r-8" *ngIf="row.data[column] === 'NO'" src="assets/svg-icon/permission-no.svg" alt="">
                  </span>
                  <div *ngIf="column !== 'Invite'" class="ellipsis">
                    <span>{{row.data[column]}}</span>
                  </div>
                </div>
                <span *ngIf="column === 'Check'">
                  <div *ngIf="checkAll" class="check-row m-auto">
                    <img src="assets/img/success-white.png" alt="">
                  </div>
                </span>
                <div *ngIf="column === 'Invite'">
                  <div *ngIf="row.data[column] === 0" (click)="invite(row.data['Email Address'])" class="chip-invite">
                    <img src="assets/img/mail-icon.png" alt="">
                    Invite
                  </div>
                  <div *ngIf="row.data[column] === 2" class="chip-invite active">
                    <img width="14px" src="assets/img/success-white.png" alt="">
                    Active
                  </div>
                  <div *ngIf="row.data[column] === 1" class="chip-invite pending">
                <!--    Pending -->
                Resend
                  </div>
                </div>
                <div *ngIf="column === 'Action'" class="pos-r text-right">
                  <img (click)="showActions = row.data" class="c-p" src="assets/svg-icon/shared.svg" alt="">
                  <div *ngIf="showActions === row.data" class="action-drb">
                    <div (click)="edit(row.data.id)" class="item">
                      <img src="assets/svg-icon/edit.svg" alt="">
                      Edit
                    </div>
                    <div (click)="delete(row.data.id)" class="item">
                      <img src="assets/svg-icon/delete.svg" alt="">
                      Delete
                    </div>
                  </div>
                </div>
              </td>
            </ng-container>
          </table>

          <div *ngIf="!data.length" class="create-btn-wrap">
            <div class="m-b-20">
              No Users Added yet
            </div>
            <button [routerLink]="[ '/main/business/create-business' ]" class="cust-button" nbButton status="success">
              + Add User
            </button>
          </div>
        </div>
      </nb-tab>
      <nb-tab tabTitle="Email Template">

        <div class="email-wrap">
          <div class="input-wrap">
            <div class="input-row">
              <div class="lable">
                Subject
              </div>
              <div class="value">
                <input class="fs-15 fw-500" type="text" nbInput fullWidth fieldSize="medium" placeholder="">
              </div>
            </div>
            <div class="input-row">
              <div class="lable">
                Message
              </div>
              <div class="value">
                <div class="mess-box">
                  <div class="m-b-21">
                    <div class="pos-r smart-textarea">
                      <div class="text">
                        {{topArea}}
                      </div>
                      <textarea [(ngModel)]="topArea" class="clear"></textarea>
                    </div>
                  </div>
                  <div (click)="secret.focus()" class="code-wrap m-b-30">
                    <span *ngFor="let item of secretNumbersArr">X</span>
                    <span *ngIf="showBlink" class="blink"></span>
                    <input style="opacity: 0; width: 0;" maxlength="7" (focus)="showBlink = true" (blur)="showBlink = false"
                      #secret class="secret-input" type="text" [(ngModel)]="secretNumber" (ngModelChange)="secretNumberChanged()">
                  </div>
                  <div>
                    <div class="pos-r smart-textarea">
                      <div class="text">
                        {{botArea}}
                      </div>
                      <textarea [(ngModel)]="botArea" class="clear"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="banner">
            <img src="assets/img/ipohe-baner.png" alt="">
          </div>
        </div>

      </nb-tab>
    </nb-tabset>
  </nb-card-body>
</nb-card>
<div *ngIf="showActions" (click)="showActions = null" class="close-bg"></div>
